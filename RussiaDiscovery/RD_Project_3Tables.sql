-- Creating three datasets for further analysis and visualization

CREATE TABLE clients (
                                        client_id UInt32,
                                        client_name String,
                                        age UInt8
                                         ) 
ENGINE = MergeTree()
ORDER BY client_id;

INSERT INTO clients
WITH 
    surnames AS (
                               SELECT arrayJoin([
                               'Иванов', 'Петров', 'Сидоров', 'Смирнов', 'Кузнецов', 'Попов', 
                               'Васильев', 'Павлов', 'Семенов', 'Голубев', 'Виноградов', 
                               'Богданов', 'Воробьев', 'Федоров', 'Михайлов', 'Беляев', 
                               'Тарасов', 'Белов', 'Комаров', 'Орлов'
                                ]) as surname
    ),
    names AS (
                         SELECT arrayJoin([
                         'Александр', 'Алексей', 'Андрей', 'Антон', 'Артем', 'Борис', 
                         'Вадим', 'Валентин', 'Валерий', 'Виктор', 'Виталий', 'Владимир', 
                         'Владислав', 'Всеволод', 'Геннадий', 'Георгий', 'Григорий', 
                          'Даниил', 'Денис', 'Дмитрий'
                         ]) as name
    ),
    patronymics AS (
                                    SELECT arrayJoin([
                                    'Александрович', 'Алексеевич', 'Андреевич', 'Антонович', 
                                    'Артемович', 'Борисович', 'Вадимович', 'Валентинович', 
                                    'Валерьевич', 'Викторович', 'Витальевич', 'Владимирович', 
                                    'Владиславович', 'Всеволодович', 'Геннадьевич', 'Георгиевич', 
                                    'Григорьевич', 'Даниилович', 'Денисович', 'Дмитриевич'
                                ]) as patronymic
    )
SELECT 
               rowNumberInAllBlocks() + (blockNumber() * 1000000) as client_id,
               concat(surname, ' ', name, ' ', patronymic) as client_name,
               rand() % 50 + 18 as age
FROM surnames, names, patronymics
LIMIT 1000;

CREATE TABLE tours (
                                       tour_id UInt32,
                                       tour_name String,
                                       region String,
                                       city String
                                       )
ENGINE = MergeTree()
ORDER BY tour_id;

INSERT INTO tours VALUES
(1, 'Золотое кольцо России', 'Центральный', 'Суздаль'),
(2, 'Золотое кольцо России', 'Центральный', 'Владимир'),
(3, 'Золотое кольцо России', 'Центральный', 'Ярославль'),
(4, 'Курорты Кавказа', 'Северо-Кавказский', 'Кисловодск'),
(5, 'Курорты Кавказа', 'Северо-Кавказский', 'Пятигорск'),
(6, 'Байкальская сказка', 'Сибирский', 'Иркутск'),
(7, 'Байкальская сказка', 'Сибирский', 'Листвянка'),
(8, 'Санкт-Петербург и пригороды', 'Северо-Западный', 'Санкт-Петербург'),
(9, 'Санкт-Петербург и пригороды', 'Северо-Западный', 'Пушкин'),
(10, 'Санкт-Петербург и пригороды', 'Северо-Западный', 'Петергоф'),
(11, 'Золотой берег Сочи', 'Южный', 'Сочи'),
(12, 'Золотой берег Сочи', 'Южный', 'Адлер'),
(13, 'Казань тысячелетняя', 'Приволжский', 'Казань'),
(14, 'Великий Новгород', 'Северо-Западный', 'Великий Новгород'),
(15, 'Калининград - янтарный край', 'Северо-Западный', 'Калининград'),
(16, 'Калининград - янтарный край', 'Северо-Западный', 'Светлогорск'),
(17, 'Алтайские горы', 'Сибирский', 'Горно-Алтайск'),
(18, 'Алтайские горы', 'Сибирский', 'Белокуриха'),
(19, 'Волжская круиз', 'Приволжский', 'Нижний Новгород'),
(20, 'Волжская круиз', 'Приволжский', 'Самара'),
(21, 'Волжская круиз', 'Приволжский', 'Волгоград'),
(22, 'Камчатка - край вулканов', 'Дальневосточный', 'Петропавловск-Камчатский'),
(23, 'Сахалин - остров у моря', 'Дальневосточный', 'Южно-Сахалинск'),
(24, 'Уральские горы', 'Уральский', 'Екатеринбург'),
(25, 'Уральские горы', 'Уральский', 'Челябинск'),
(26, 'Золотые пески Крыма', 'Крым', 'Ялта'),
(27, 'Золотые пески Крыма', 'Крым', 'Севастополь'),
(28, 'Золотые пески Крыма', 'Крым', 'Феодосия'),
(29, 'Соловецкие острова', 'Северо-Западный', 'Соловки'),
(30, 'Валаам - северная жемчужина', 'Северо-Западный', 'Валаам');

CREATE TABLE orders (
                                          order_id UInt32,
                                          client_id UInt32,
                                          tour_id UInt32,
                                          amount Decimal(10, 2),
                                          purchase_date Date
                                        )
ENGINE = MergeTree()
ORDER BY order_id;

INSERT INTO orders
WITH 
    numbers AS (
                             SELECT number as n
        FROM numbers(1000)
    )
SELECT 
              n as order_id,
             (rand() % 1000) + 1 as client_id,
             (rand() % 30) + 1 as tour_id,
             round(rand() * 100000 + 10000, 2) as amount,
             toDate('2023-01-01') + (rand() % 731) as purchase_date             
FROM numbers;
